# Perla Metro Routes Services

## ğŸ“‹ DescripciÃ³n

Servicio backend para la gestiÃ³n y cÃ¡lculo de rutas del sistema de metro Perla. Este proyecto utiliza Neo4j como base de datos de grafos para modelar eficientemente la red de transporte y calcular las rutas Ã³ptimas entre estaciones.

## ğŸš€ CaracterÃ­sticas

- **Base de datos de grafos**: Utiliza Neo4j para representar estaciones y conexiones del metro
- **CÃ¡lculo de rutas**: Algoritmos optimizados para encontrar las mejores rutas entre estaciones
- **API REST**: Endpoints para consultar informaciÃ³n de estaciones y rutas
- **Escalable**: Arquitectura diseÃ±ada para soportar mÃºltiples lÃ­neas de metro

## ğŸ› ï¸ TecnologÃ­as

- **Node.js**: Entorno de ejecuciÃ³n
- **Neo4j**: Base de datos de grafos
- **Express.js**: Framework web (presumiblemente)
- **Neo4j Driver**: Cliente oficial de Neo4j para Node.js

## ğŸ“¦ Requisitos Previos

- Node.js (v14 o superior)
- Neo4j (v4.0 o superior)
- npm o yarn

## ğŸ”§ InstalaciÃ³n

1. **Clonar el repositorio**
```bash
git clone https://github.com/Taller-1-Arq-de-Sistemas/perla-metro-routes-services.git
cd perla-metro-routes-services
```

2. **Instalar dependencias**
```bash
npm install
```

3. **Configurar variables de entorno**

Crear un archivo `.env` en la raÃ­z del proyecto:
```env
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=tu_password
PORT=3000
```

4. **Iniciar Neo4j**

AsegÃºrate de tener Neo4j corriendo en tu mÃ¡quina local o configura la conexiÃ³n a una instancia remota.

5. **Iniciar el servidor**
```bash
npm start
```

## ğŸ“ Estructura del Proyecto

```
BACKROUTE/
â”œâ”€â”€ src/
|   |
|   â”œâ”€â”€controller/
|   |   â””â”€â”€ routeStation.js       #controlador de routeServices
|   |   â””â”€â”€ station.js            # controlador de station
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ neo4j.js              # ConfiguraciÃ³n 
|   |   â””â”€â”€ connection.JS         # ConexiÃ³n a Neo4j
|   â”œâ”€â”€ middlewares/
|   |    â””â”€â”€cors.js 
â”‚   â”œâ”€â”€ repositories/             # Capa de acceso a datos (Repository Pattern)
â”‚   â”‚   â”œâ”€â”€ funcionStationValidator.js  # Repositorio de estaciones
â”‚   â”‚   â””â”€â”€ funtionRouteValidator.js    # Repositorio de rutas
â”‚   â”‚   
â”‚   â”œâ”€â”€ routes/                   # Rutas de la API
â”‚   â”‚   â”œâ”€â”€ routeRoutes.js
â”‚   â”‚   â””â”€â”€ stationRoutes.js
â”‚   â””â”€â”€ models/                   # Modelos de datos
|   |   â””â”€â”€ routeStation.js       # modelos de LA RUTA
|   |   â””â”€â”€ station.js            # modelos de la estaciÃ³n
|   |
|   â”œâ”€â”€ validator/
|    |    â””â”€â”€ validatorRouteStation.js       # modelos de LA RUTA
|   |   â””â”€â”€ validatorStation.js      
â”œâ”€â”€app.js  
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## ğŸ—„ï¸ Modelo de Datos

El modelo de datos en Neo4j representa:

- **Nodos EstaciÃ³n**: Cada estaciÃ³n del metro
- **Relaciones CONECTA_CON**: Conexiones entre estaciones
- **Propiedades**: Tiempo de viaje, distancia, lÃ­nea de metro, etc.

### Ejemplo de estructura:
```cypher
(EstaciÃ³n A)-[:CONECTA_CON {tiempo: 3, distancia: 2.5, linea: "A"}]->(EstaciÃ³n B)
```

## ğŸ”Œ API Endpoints

### Obtener todas las estaciones
```http
GET /api/stations
```

### Obtener estaciÃ³n por ID
```http
GET /api/stations/:id
```

### Calcular ruta Ã³ptima
```http
POST /api/routes/calculate
Content-Type: application/json

{
  "origin": "EstaciÃ³n A",
  "destination": "EstaciÃ³n Z"
}
```

### Obtener lÃ­neas de metro
```http
GET /api/lines
```

## ğŸ’¡ Uso

### Ejemplo: Calcular una ruta
```javascript
const response = await fetch('http://localhost:3000/api/routes/calculate', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    origin: 'EstaciÃ³n Central',
    destination: 'EstaciÃ³n Norte'
  })
});

const route = await response.json();
console.log(route);
```
ğŸ—ï¸ PatrÃ³n de DiseÃ±o: Repository
Este proyecto implementa el patrÃ³n Repository para abstraer la lÃ³gica de acceso a datos y mantener el cÃ³digo organizado, testeable y mantenible.
Â¿QuÃ© es el patrÃ³n Repository?
El patrÃ³n Repository actÃºa como una capa intermedia entre la lÃ³gica de negocio (servicios) y la capa de acceso a datos (base de datos). Proporciona una interfaz limpia para realizar operaciones CRUD sin exponer los detalles de implementaciÃ³n de la base de datos.
Ventajas del patrÃ³n

âœ… SeparaciÃ³n de responsabilidades: Separa la lÃ³gica de negocio del acceso a datos
âœ… Testabilidad: Facilita la creaciÃ³n de mocks y tests unitarios
âœ… Mantenibilidad: Cambios en la BD no afectan la lÃ³gica de negocio
âœ… ReutilizaciÃ³n: Los repositorios pueden ser usados por mÃºltiples servicios
âœ… AbstracciÃ³n: Oculta la complejidad de las consultas Cypher a Neo4j


## ğŸ‘¥ Autores

Proyecto desarrollado como parte del Taller 1 de Arquitectura de Sistemas.

